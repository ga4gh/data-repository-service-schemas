
syntax = "proto3";

package ga4gh_data_object;

// Import HTTP RESTful annotations
// from github.com/googleapis/googleapis
import "google/api/annotations.proto";

import "data_objects.proto";


//Web service to get, create, list and delete Data Objects
service DataObjectService {

  //Make a new object
  rpc CreateObject(DataObject) returns (AddDataObjectResponse) {
    option (google.api.http) = {
      post: "/ga4gh/dos/v1/objects/{id}"
      body: "*"
    };
  }

  //Update or create a new version of a object (depending on the capabilities of this implementation). For systems that support versioning, the combination of ID and version must be unique e.g. systems cannot support versioning and also allow changes to previous versions.
  rpc UpdateObject(DataObject) returns (AddDataObjectResponse) {
    option (google.api.http) = {
      put: "/ga4gh/dos/v1/objects/{id}"
      body: "*"
    };
  }

  //Get info about a object
  rpc GetObjectStatus(GetDataObjectRequest) returns (ObjectStatusResponse) {
      option (google.api.http) = {
        get: "/ga4gh/dos/v1/objects/{id}/versions"
      };
  }

  //Get info about objects sharing a SHA256 checksum
  rpc GetObjectChecksumStatus(GetDataObjectChecksumRequest) returns (ObjectChecksumStatusResponse) {
      option (google.api.http) = {
        get: "/ga4gh/dos/v1/objects-by-checksum/{checksum}"
      };
  }

  //Get info about the clouds a object is on
  rpc GetObjectClouds(GetDataObjectRequest) returns (DataObjectCloudsResponse) {
      option (google.api.http) = {
        get: "/ga4gh/dos/v1/objects/{id}/clouds"
      };
  }

  //For a given cloud, create a signed URL for accessing this object
  rpc GetObjectCloudsSignedURL(GetDataObjectCloudRequest) returns (DataObjectSignedURLResponse) {
      option (google.api.http) = {
        get: "/ga4gh/dos/v1/objects/{id}/signedurl"
      };
  }

  //For a given cloud, return the native path and optionally credentials for accessing this object
  rpc GetObjectCloudsNativeURL(GetDataObjectCloudRequest) returns (DataObjectNativeURLResponse) {
      option (google.api.http) = {
        get: "/ga4gh/dos/v1/objects/{id}/nativeurl"
      };
  }

  //Delete a object
  rpc DeleteObject(DeleteDataObjectRequest) returns (GetDataObjectRequest) {
      option (google.api.http) = {
        delete: "/ga4gh/dos/v1/objects/{id}"
      };
  }

  //List the objects
  rpc ListObjects(ListDataObjectsRequest) returns (ListDataObjectsResponse) {
    option (google.api.http) = {
      get: "/ga4gh/dos/v1/objects/list"
    };
  }

  //Make a new data bundle
  rpc CreateDataBundle(DataBundleObject) returns (AddDataBundleObjectResponse) {
    option (google.api.http) = {
      post: "/ga4gh/dos/v1/databundles/{id}"
      body: "*"
    };
  }

  //Update or create a new version of a data bundle (depending on the capabilities of this implementation). For systems that support versioning, the combination of ID and version must be unique e.g. systems cannot support versioning and also allow changes to previous versions.
  rpc UpdateDataBundle(DataBundleObject) returns (AddDataBundleObjectResponse) {
    option (google.api.http) = {
      put: "/ga4gh/dos/v1/databundles/{id}"
      body: "*"
    };
  }

  //Get info about a data bundle
  rpc GetDataBundleStatus(GetDataBundleObjectRequest) returns (DataBundleStatusResponse) {
      option (google.api.http) = {
        get: "/ga4gh/dos/v1/databundles/{id}/versions"
      };
  }

  //Get info about data bundles sharing a SHA256 checksum
  rpc GetDataBundleChecksumStatus(GetDataBundleObjectChecksumRequest) returns (DataBundleChecksumStatusResponse) {
      option (google.api.http) = {
        get: "/ga4gh/dos/v1/databundles-by-checksum/{checksum}"
      };
  }

  //Delete a data bundle
  rpc DeleteDataBundle(DeleteDataBundleObjectRequest) returns (GetDataBundleObjectRequest) {
      option (google.api.http) = {
        delete: "/ga4gh/dos/v1/databundles/{id}"
      };
  }

  //List the data bundles
  rpc ListDataBundles(ListDataBundleObjectsRequest) returns (ListDataBundleObjectsResponse) {
    option (google.api.http) = {
      get: "/ga4gh/dos/v1/databundles/list"
    };
  }

}
